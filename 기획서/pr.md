## π“ Summary

### μ£Όλ¬Έ λ„λ©”μΈ κµ¬ν„

μ΄λ² PRμ—μ„λ” μ£Όλ¬Έ λ„λ©”μΈμ ν•µμ‹¬ κΈ°λ¥μ„ κµ¬ν„ν–μµλ‹λ‹¤. μ‚¬μ©μκ°€ μƒν’μ„ μ§μ ‘ μ£Όλ¬Έν•κ±°λ‚ μ¥λ°”κµ¬λ‹λ¥Ό ν†µν•΄ μ£Όλ¬Έν•  μ μλ” κΈ°λ¥μ„ μ κ³µν•©λ‹λ‹¤.

### μ£Όμ” κµ¬ν„ λ‚΄μ©

#### 1. λ„λ©”μΈ λ¨λΈ μ„¤κ³„
- **Order (μ£Όλ¬Έ μ—”ν‹°ν‹°)**: μ£Όλ¬Έμ κΈ°λ³Έ μ •λ³΄λ¥Ό κ΄€λ¦¬
  - `orderKey`: UUID κΈ°λ°μ κ³ μ  μ£Όλ¬Έ μ‹λ³„μ
  - `userId`: μ£Όλ¬Έν• μ‚¬μ©μ ID
  - `totalPrice`: μ „μ²΄ μ£Όλ¬Έ κΈμ•΅
  - `orderStatus`: μ£Όλ¬Έ μƒνƒ (PENDING, PAYMENT_SUCCESS λ“±)
  - `payType`: κ²°μ  μλ‹¨ (CREDIT_CARD, SMART_PAY)
  - `shippingAddress`: λ°°μ†΅μ§€ μ£Όμ†

- **OrderItem (μ£Όλ¬Έ μ•„μ΄ν… μ—”ν‹°ν‹°)**: μ£Όλ¬Έ λ‚΄ κ°λ³„ μƒν’ μ •λ³΄λ¥Ό μ¤λƒ…μƒ·μΌλ΅ μ €μ¥
  - μƒν’ μ •λ³΄ μ¤λƒ…μƒ· (productName, productPrice)
  - μλ‰ λ° κ°λ³„ μ΄μ•΅ μ €μ¥

- **λ„λ©”μΈ κ°μ²΄λ“¤**:
  - `NewOrder`, `NewOrderItem`: μ£Όλ¬Έ μƒμ„±μ„ μ„ν• λ¶λ³€ κ°μ²΄ (record)
  - `OrderRecord`: μ£Όλ¬Έ μ΅°νλ¥Ό μ„ν• μ‘λ‹µ κ°μ²΄ (record)
  - `OrderStatus`: μ£Όλ¬Έ μƒνƒλ¥Ό κ΄€λ¦¬ν•λ” enum
  - `PayType`: κ²°μ  μλ‹¨μ„ κ΄€λ¦¬ν•λ” enum

#### 2. ν•µμ‹¬ λΉ„μ¦λ‹μ¤ λ΅μ§ (OrderService)

**μ£Όλ¬Έ μƒμ„± ν”„λ΅μ„Έμ¤** (src/main/java/com/commerce/domain/order/application/OrderService.java:44-85)
1. μ£Όλ¬Έν•  μƒν’ λ©λ΅ μ΅°ν
2. μ£Όλ¬Έ μ ν¨μ„± κ²€μ¦
   - μƒν’ μ΅΄μ¬ μ—¬λ¶€
   - μƒν’ ID μΌμΉ μ—¬λ¶€
   - μ¬κ³  μ¶©λ¶„ μ—¬λ¶€
3. μ΄ κΈμ•΅ κ³„μ‚°
4. μ£Όλ¬Έ μ—”ν‹°ν‹° μƒμ„± λ° μ €μ¥ (PENDING μƒνƒ)
5. μ£Όλ¬Έ μ•„μ΄ν… μ €μ¥ (μƒν’ μ •λ³΄ μ¤λƒ…μƒ·)
6. μ¬κ³  μ°¨κ°

**μ£Όλ¬Έ μ΅°ν** (src/main/java/com/commerce/domain/order/application/OrderService.java:87-113)
- orderKeyλ΅ μ£Όλ¬Έ μ΅°ν
- μ£Όλ¬Έ μ†μ μ κ²€μ¦
- PENDING μƒνƒ ν™•μΈ (μ²΄ν¬μ•„μ›ƒ ν™”λ©΄μ©)

#### 3. API μ—”λ“ν¬μΈνΈ (OrderController)
- `POST /v1/orders`: μ§μ ‘ μ£Όλ¬Έ μƒμ„±
- `POST /v1/cart-orders`: μ¥λ°”κµ¬λ‹λ΅λ¶€ν„° μ£Όλ¬Έ μƒμ„±
- `GET /v1/orders/{orderKey}`: μ£Όλ¬Έ μ΅°ν (μ²΄ν¬μ•„μ›ƒ ν™”λ©΄)

#### 4. μ£Όμ” μ„¤κ³„ κ²°μ •μ‚¬ν•­

**OrderKey μƒμ„± μ „λµ** (src/main/java/com/commerce/domain/order/application/OrderKeyGenerator.java:9-11)
- UUID + userId μ΅°ν•©μΌλ΅ μƒμ„±
- κ³ μ μ„± λ³΄μ¥ λ° μ‚¬μ©μλ³„ μ‹λ³„ κ°€λ¥

**μƒν’ μ •λ³΄ μ¤λƒ…μƒ·**
- μ£Όλ¬Έ μ‹μ μ μƒν’λ…κ³Ό κ°€κ²©μ„ OrderItemμ— μ €μ¥
- ν–¥ν›„ μƒν’ μ •λ³΄ λ³€κ²½μ—λ„ μ£Όλ¬Έ μ΄λ ¥ μ μ§€

**μ¬κ³  μ°¨κ° μ‹μ **
- μ£Όλ¬Έ μƒμ„± μ‹ μ¦‰μ‹ μ¬κ³  μ°¨κ°
- Product μ—”ν‹°ν‹°μ decreaseStock() λ©”μ„λ“ ν™μ©

## π’¬ Review Points

### 1. λ„λ©”μΈ λ¨λΈ μ„¤κ³„
- **Orderμ™€ OrderItemμ κ΄€κ³„**: ν„μ¬ μ—°κ΄€κ΄€κ³„ λ§¤ν•‘ μ—†μ΄ orderIdλ΅λ§ μ—°κ²°λμ–΄ μμµλ‹λ‹¤. μ΄ μ„¤κ³„κ°€ μ μ ν•κ°€μ”?
  - μ¥μ : N+1 λ¬Έμ  νν”Ό, μΏΌλ¦¬ μµμ ν™” κ°€λ¥
  - λ‹¨μ : κ°μ²΄ μ§€ν–¥μ  κ΄€μ μ—μ„ μ—°κ΄€κ΄€κ³„ λ¶€μ΅±

- **λ„λ©”μΈ κ°μ²΄ κµ¬μ΅°**: Order μ—”ν‹°ν‹°μ— λΉ„μ¦λ‹μ¤ λ΅μ§μ΄ κ±°μ μ—†κ³  λ€λ¶€λ¶„ OrderServiceμ— μ§‘μ¤‘λμ–΄ μμµλ‹λ‹¤. λ„λ©”μΈ λ΅μ§μ„ μ—”ν‹°ν‹°λ΅ μ΄λ™μ‹ν‚¤λ” κ²ƒμ΄ μΆ‹μ„κΉμ”?

### 2. λ™μ‹μ„± μ²λ¦¬
- **μ¬κ³  μ°¨κ° λ΅μ§** (src/main/java/com/commerce/domain/order/application/OrderService.java:79-82):
  - ν„μ¬ `Product.decreaseStock()` λ©”μ„λ“λ΅ μ¬κ³ λ¥Ό μ°¨κ°ν•κ³  μμµλ‹λ‹¤
  - λ™μ‹μ— μ—¬λ¬ μ£Όλ¬Έμ΄ λ“¤μ–΄μ¬ κ²½μ° μ¬κ³  μ°¨κ°μ λ™μ‹μ„± λ¬Έμ κ°€ λ°μƒν•  μ μμµλ‹λ‹¤
  - λΉ„κ΄€μ  λ½(Pessimistic Lock), λ‚™κ΄€μ  λ½(Optimistic Lock), λλ” Redisλ¥Ό ν™μ©ν• λ¶„μ‚° λ½ λ“±μ λ™μ‹μ„± μ μ–΄κ°€ ν•„μ”ν• κΉμ”?

### 3. νΈλμ­μ… λ²”μ„
- **OrderService.createOrder()**:
  - μ£Όλ¬Έ μƒμ„±, μ£Όλ¬Έ μ•„μ΄ν… μ €μ¥, μ¬κ³  μ°¨κ°μ΄ ν•λ‚μ νΈλμ­μ…μΌλ΅ λ¬¶μ—¬ μμµλ‹λ‹¤
  - νΈλμ­μ… λ²”μ„κ°€ μ μ ν•κ°€μ”?
  - λ§μ•½ μ¬κ³  μ°¨κ° μ‹¤ν¨ μ‹ λ΅¤λ°± μ²λ¦¬κ°€ μ¬λ°”λ¥΄κ² λλ”μ§€ ν™•μΈμ΄ ν•„μ”ν•©λ‹λ‹¤

### 4. μμ™Έ μ²λ¦¬ λ° κ²€μ¦
- **μ—λ¬ λ©”μ‹μ§€ μ μ μ„±**:
  - ErrorType.CART_IS_EMPTYλ¥Ό μ£Όλ¬Έ κ²€μ¦μ— μ‚¬μ© (src/main/java/com/commerce/domain/order/application/OrderService.java:130)
  - ErrorType.CART_ITEM_NOT_FOUNDλ¥Ό μ£Όλ¬Έ μ•„μ΄ν… μ΅°ν μ‹¤ν¨ μ‹ μ‚¬μ© (src/main/java/com/commerce/domain/order/application/OrderService.java:102)
  - μ£Όλ¬Έ λ„λ©”μΈμ— λ§λ” λ³„λ„μ μ—λ¬ νƒ€μ…μ΄ ν•„μ”ν• κΉμ”?

### 5. OrderKey μƒμ„± μ „λµ
- **OrderKeyGenerator** (src/main/java/com/commerce/domain/order/application/OrderKeyGenerator.java:9-11):
  - ν„μ¬ `UUID + userId` μ΅°ν•© μ‚¬μ©
  - userIdκ°€ λ…Έμ¶λλ” λ³΄μ• μ΄μκ°€ μμ„ μ μμµλ‹λ‹¤
  - UUIDλ§ μ‚¬μ©ν•κ±°λ‚, λ‹¤λ¥Έ μ „λµ(μ: Snowflake ID, ULID)μ„ κ³ λ ¤ν•΄λ³Ό λ§ν•κ°€μ”?

### 6. μ£Όλ¬Έ κΈμ•΅ κ³„μ‚°
- **κ°€κ²© κ³„μ‚° λ΅μ§** (src/main/java/com/commerce/domain/order/application/OrderService.java:115-125):
  - BigDecimalλ΅ μ •ν™•ν• κΈμ•΅ κ³„μ‚°μ„ ν•κ³  μμµλ‹λ‹¤
  - μ¶”ν›„ ν• μΈ, μΏ ν°, ν¬μΈνΈ μ μ© μ‹ μ΄ λ΅μ§μ ν™•μ¥μ„±μ€ μ–΄λ–¨κΉμ”?

### 7. μ½”λ“ ν’μ§
- κ²€μ¦ λ΅μ§κ³Ό κ³„μ‚° λ΅μ§μ„ private λ©”μ„λ“λ΅ μ λ¶„λ¦¬ν–μµλ‹λ‹¤
- λ§¤μ§ λ„λ²„λ‚ ν•λ“μ½”λ”©λ κ°’μ΄ μ—†λ”μ§€ ν™•μΈ λ¶€νƒλ“λ¦½λ‹λ‹¤
- ν…μ¤νΈ μ½”λ“ μ‘μ„± μ—¬λ¶€ ν™•μΈμ΄ ν•„μ”ν•©λ‹λ‹¤

## β… Checklist

- [ ] μ£Όλ¬Έ μƒμ„± κΈ°λ¥ λ™μ‘ ν™•μΈ
- [ ] μ¥λ°”κµ¬λ‹λ΅λ¶€ν„° μ£Όλ¬Έ μƒμ„± λ™μ‘ ν™•μΈ
- [ ] μ¬κ³  λ¶€μ΅± μ‹ μμ™Έ μ²λ¦¬ ν™•μΈ
- [ ] μ΅΄μ¬ν•μ§€ μ•λ” μƒν’ μ£Όλ¬Έ μ‹ μμ™Έ μ²λ¦¬ ν™•μΈ
- [ ] λ‹¤λ¥Έ μ‚¬μ©μμ μ£Όλ¬Έ μ΅°ν μ‹ μμ™Έ μ²λ¦¬ ν™•μΈ
- [ ] λ™μ‹ μ£Όλ¬Έ λ°μƒ μ‹ μ¬κ³  μ°¨κ° μ •ν™•μ„± ν™•μΈ
- [ ] νΈλμ­μ… λ΅¤λ°± μ‹λ‚λ¦¬μ¤ ν…μ¤νΈ
- [ ] λ‹¨μ„ ν…μ¤νΈ μ‘μ„± μ™„λ£
- [ ] ν†µν•© ν…μ¤νΈ μ‘μ„± μ™„λ£

## π“ References

### μ£Όμ” νμΌ μ„μΉ
- λ„λ©”μΈ λ¨λΈ: `src/main/java/com/commerce/domain/order/domain/`
- λΉ„μ¦λ‹μ¤ λ΅μ§: `src/main/java/com/commerce/domain/order/application/OrderService.java`
- API μ»¨νΈλ΅¤λ¬: `src/main/java/com/commerce/controller/v1/OrderController.java`
- λ ν¬μ§€ν† λ¦¬: `src/main/java/com/commerce/domain/order/repository/`